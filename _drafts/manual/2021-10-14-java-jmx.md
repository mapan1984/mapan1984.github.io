# Jmx(Java Management Extensions)

## 概念

jmx 机制可以将正在运行的 java 程序内部的对象暴露出来，通过 jmx 获取到暴露的对象后，可以获取/设置这个对象的属性，调用这个对象的方法。

这个对象被称为 `MBean` (Managed Bean)，需要以一个 `ObjectName` 作为定位标记注册到 `MBeanServer` 中。

- `MBean`：就是一个 Java Object
    - `Attribute`: MBean 对象包含的属性，通过 set/get 方法暴露
    - `Operations`: 其他 MBean 对象方法

`MBean` 会注册在 `MBeanServer` 中，使用 `ObjectName` 定位

- `ObjectName`: 包含 2 部分
    - `domain`：不包含冒号的字符串
    - `properties`：无序的 key-value 序列

`domain` 和 `properties` 都支持正则

    domain:<beanpropertyName1=beanPropertyValue1, beanpropertyName2=beanPropertyValue2, ...><key1, key2, ...>attrName: value

    domain_beanPropertyValue1_key1_key2_...keyN_attrName{beanpropertyName2="beanPropertyValue2", ...}: value

- `MBeanServer`：`MBean` 注册在一个 `MBeanServer` 中。

## 开启 jmx

    -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.port=5555

## 连接


``` java
try {
    JMXServiceURL url = new JMXServiceURL("service:jmx:rmi:///jndi/rmi://127.0.0.1:5555/jmxrmi");
    JMXConnector jmxc = JMXConnectorFactory.connect(url, null);

    MBeanServerConnection mbsc = jmxc.getMBeanServerConnection();

    ObjectName objectName = new ObjectName("io.github.mapan1984:type=basic,name=game");

    String name = mbsc.getAttribute(objectName, "playerName").toString();
} catch (Exception e) {
    e.printStackTrace();
}
```
