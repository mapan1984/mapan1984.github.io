---
layout: post 
title: vim 奇技淫巧 
categories: [linux]
tags: [vim]
---

### 复制，粘贴，删除
    
    y yank
    yy 复制当前行(yank)
    p paste
    P 在光标上一行paste
    x 删除当前字符
    dd 删除当前行(delete)

### 各种插入

    i (insert)
    I 在本行第一个字符前插入
    a (after)
    A 在行末尾插入, 比如A;
    o 向下插入一行
    O 向上插入一行
    s 清除一个字符插入
    S 清除一行内容插入
    cNw 删除N个词后插入
    cc 清除一行插入
    C 删除光标后的内容后插入
    r 替换一个字符
    R 从当前位置连续替换字符
 
### 对括号，引号，标签内容的操作

i代表inner

    di{ 删除{}里所有的代码
    di( 把()清空为()
    di[ 清空[]
    di< 
    di"
    di'
    di`
    dit 删除一对html/xml的标签内的所有字符

将i换为a可以在操作时包含两边的标签

    da{ 连带着删除{}和它里面的所有东西

c与d的作用相同(我习惯用d代表delete)

将d换位v, y可以完成选定和复制

    vi{ 选定
    yi{ 复制

### 缩进

    >> 向右给它进当前行 
    << 向左缩进当前行
    = 缩进当前行 （和上面不一样的是，它会对齐缩进）

可以和移动配合，比如:

    =% 把光标位置移到语句块的括号上，然后按=%，缩进整个语句块（%是括号匹配）
    gg=G 缩进整个文件（G是到文件结尾，gg是到文件开头）

### 还原操作
    
    u - 撤销操作
    U - 撤销整行操作
    ctrl+R - 恢复撤销

### 关键字补全

在insert模式下，我们可以按如下快捷键：

    Ctrl+N  – 当你按下这它时，你会发现Vim就开始搜索你这个目录下的代码，搜索完成了就会出现一个下拉列表
    Ctrl+P – 接下来你可以按这个键，于是回到原点，然后你可以按上下光标键来选择相应的Word。

我们按下了Ctrl+P后，光标回到了一开始输入的位置，然后你可以干两件事，一个是继续输入（这可以帮助过滤关键词），另一个是用“光标键”上移或下移来选择下拉列表中的关键字，选好后回车，就补全了。

与此类似的，还有更多的补齐，都在Ctrl +X下面：

    Ctrl+X 和 Ctrl+D 宏定义补齐
    Ctrl+X 和 Ctrl+] Tag 补齐
    Ctrl+X 和 Ctrl+F 文件名 补齐
    Ctrl+X 和 Ctrl+I 也是关键词补齐，但是关键后会有个文件名，告诉你这个关键词在哪个文件中
    Ctrl+X 和 Ctrl+V 表达式补齐
    Ctrl+X 和 Ctrl+L 对整个行补齐

### 宏(macro)

    qa 将之后的所有键盘操作录制下来，直到再次在命令模式按下q，并存储在a中
    @a 执行刚刚记录在a里面的键盘操作
    @@ 执行上一次的macro操作

宏操作是VIM最为神奇的操作之一，需要慢慢体会其强大之处

### 保存会话

如果你用Tab或Window打开了好些文件的文件，还设置了各种滚屏同步，或是行号……，那么，你可以用下面的命令来保存会话：（你有兴趣你可以看看你的mysession.vim文件内容，也就是一个批处理文件）

    :mksession ~/.mysession.vim

如果文件重复，vim默认会报错，如果你想强行写入的话，你可以在mksession后加! ：

    :mksession! ~/.mysession.vim

于是下次，你可以这样打开这个会话：

    vim -S ~/.mysession.vim

保存完会话后，你也没有必要一个一个Tab/Windows的去Close。你可以简单地使用：

    :qa   – 退出全部 
    :wqa  -保存全部并退出全部

### 执行外部命令

可以在vim中输入“:!cmd”执行外部命令“cmd”,比如:

    :!python %   运行当前编写的python程序(%会展开为__file__)

`:r !cmd`可以执行“cmd”并把其标准输出打印的下一行(:r为读取命令),比如:

    :r!date 把当前时间输出到文件

    :r !cal   运行“cal”,在下一行插入日历
    效果:
         April 2016
    Su Mo Tu We Th Fr Sa
                    1  2 
     3  4  5  6  7  8  9 
    10 11 12 13 14 15 16 
    17 18 19 20 21 22 23 
    24 25 26 27 28 29 30 

### 执行脚本

在任何格式的文本中，想插入一些数据，只需要写一小段代码，然后选中这段代码，执行!python 

Tada! 这段代码的执行结果就被插入在了这段代码所在的位置。连删除这段代码的操作都不需要了。比如:

    新年倒计时开始：
    for i in range(10, 0, -1):
        print(i, '!')

选中的代码，并按下 !python:

    新年倒计时开始：
        10 !
        9 !
        8 !
        7 !
        6 !
        5 !
        4 !
        3 !
        2 !
        1 !

### 字符相关

    guu – 把一行的文字变成全小写。或是【Vu】
    gUU – 把一行的文件变成全大写。或是【VU】
    按v键进入选择模式，然后移动光标选择你要的文本，按u转小写，按U转大写
    gU 变大写
    gu 变小写
    ga 查看光标处的ascii码
    g8 查看光标处的utf-8编码
    ctrl+a 把光标下的数字加1
    ctrl+x 吧光标下的数字减1

### 未分类

    :%TOhtml 转换为HTML文件
    ctrl-w 在insert模式下删除一个词
    J 合并下一行与当前行
    gf 打开光标处的文件（这个命令在打到#include头文件时挺好用的，当然，仅限于有路径的）
